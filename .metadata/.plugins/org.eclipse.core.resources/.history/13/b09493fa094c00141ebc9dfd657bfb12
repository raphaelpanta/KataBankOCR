package raphaelpantaleao.katabanckocr;

import static javax.swing.SwingUtilities.invokeAndWait;
import static javax.swing.SwingUtilities.invokeLater;

import java.awt.Dimension;
import java.awt.FlowLayout;
import java.awt.HeadlessException;
import java.io.ByteArrayInputStream;
import java.io.InputStream;
import java.lang.reflect.InvocationTargetException;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;

import raphaelpantaleao.katabanckocr.models.Document;

public class Main {
	
	public static void main(String[] args) throws HeadlessException,
			InvocationTargetException, InterruptedException {
		invokeAndWait(() -> {
			Document doc;
			final JFrame topLevelFrame = new JFrame("BankOCR App") {
				private static final long serialVersionUID = 189221029764492414L;

				{
					setName("Bank OCR");
					setLayout(new FlowLayout());
					setDefaultCloseOperation(EXIT_ON_CLOSE);
					setPreferredSize(new Dimension(350, 300));

					add(new JLabel("Input:") {
						{
							setName("input");
						}
					});

					final JTextArea inputTextArea = new JTextArea("") {
						{
							setName("input text area");
							setRows(3);
							setColumns(27);
							setEditable(false);
						}
					};

					final JTextArea outputTextArea = new JTextArea("") {
						{
							setName("output text area");
							setRows(1);
							setColumns(9);
							setEditable(false);
						}
					};
					final JButton scannerButton = new JButton("Scan File...") {
						{
							setName("scanner button");
							setEnabled(false);
							addActionListener((event) -> {
								invokeLater(()->{
									outputTextArea.append("123456789\n");
								});
						});
						}
					};
					add(new JButton("Select File...") {
						{
							setName("select file button");
							addActionListener((event) -> {
								invokeLater(() -> {
									String scannedText = "  _  _     _  _  _  _  _ \n"
											+ "| _| _||_||_ |_   ||_||_|\n"
											+ "||_  _|  | _||_|  ||_| _|\n";
									InputStream stream = null;
									try {
										stream = new ByteArrayInputStream(scannedText.getBytes("UTF-8"));
									} catch (Exception e) {
										// TODO Auto-generated catch block
										e.printStackTrace();
									}
									doc = Document.process(stream);
									inputTextArea
											.append(scannedText);
									scannerButton.setEnabled(true);
								});

							});
						}
					});

					add(new JScrollPane(inputTextArea));

					add(new JLabel("Output:") {
						{
							setName("output");
						}
					});

					add(scannerButton);

					add(new JScrollPane(outputTextArea));

					pack();
				}
			};
			topLevelFrame.setVisible(true);
		});
	}
}
