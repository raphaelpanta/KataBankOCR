package raphaelpantaleao.katabanckocr;

import static javax.swing.SwingUtilities.invokeAndWait;
import static raphaelpantaleao.katabanckocr.listeners.NonBlokingActionListener.invokeLater;

import java.awt.HeadlessException;
import java.lang.reflect.InvocationTargetException;

import javax.swing.JFileChooser;

import raphaelpantaleao.katabanckocr.listeners.ScanFileListener;
import raphaelpantaleao.katabanckocr.listeners.SelectFileListener;
import raphaelpantaleao.katabanckocr.models.Document;
import raphaelpantaleao.katabankocr.ui.UIFrame;

public class Main {
	public static void main(String[] args) throws HeadlessException,
			InvocationTargetException, InterruptedException {
		invokeAndWait(() -> {
			final Document doc = new Document();
			final JFileChooser jFileChooser = createFileChooser();
			UIFrame topLevelFrame = extracted(doc, jFileChooser);
			topLevelFrame.setVisible(true);
		});
	}

	private static UIFrame extracted(final Document doc,
			final JFileChooser jFileChooser) {
		UIFrame topLevelFrame = new UIFrame("Bank OCR", "BankOCR App") {
			private static final long serialVersionUID = -4459872068101440744L;

			{
				addScanFileListener(invokeLater(new ScanFileListener(doc,
						this)));
				addSelectFileListener(invokeLater(new SelectFileListener(
						this, jFileChooser, doc)));
			}
		};
		return topLevelFrame;
	}

	private static JFileChooser createFileChooser() {
		final JFileChooser jFileChooser = new JFileChooser() {
			private static final long serialVersionUID = 1L;

			{
				setName("file chooser");
			}
		};
		return jFileChooser;
	}
}
